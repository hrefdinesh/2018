<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>jQuery UI Sortable - Default functionality</title>
    <link rel="stylesheet" href="css/jquery-ui.min.css">
    <style>
    .unlist {
        list-style-type: none;
        margin: 0;
        padding: 0;
        width: 100%;
        max-width: 350px;
    }

    .unlist li {
        margin: 0 3px 3px 3px;
        padding: 0.4em 0.4em;
        font-size: 1.4em;
    }

    .unlist li span {
        position: absolute;
        margin-left: -1.3em;
    }
    .team-img img{
        max-width: 80px;
    }
    </style>
</head>

<body>

    <ul class="unlist league"></ul>
    <div class="unlist semi-finals"></div>




    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script>
    $(function() {

        var simulatedWinner = '';
        var shareBucket = "teams/";        
        var imgBucket = "img/icons_plain/";
        var imgBucketbg = "img/icons_bg/";
        var winnersBucket = "teams/";
        var jsonBucket = "data/";



        //  Team Sortable 
        $(".league").sortable({
            start: function(e, ui) {
                // creates a temporary attribute on the element with the old index
                $(this).attr('data-previndex', ui.item.index());
            },
            update: function(e, ui) {
                var idsInOrder = $(".league").sortable("toArray");  
               
                idsInOrder = idsInOrder.slice(0,4);

          
                drawSemiMatches(idsInOrder);
            }
        });

        function drawSemiMatches(idsInOrder) {
         
            var semiFinals = $('.semi-finals');  
            $('.semi-finals li').remove();

            $.each(idsInOrder, function(index, vale) {
                $.each(groupsArray, function(index, team) {
                    if(vale == team.teamid) {
                        console.log(team.displayName)
                        var li = "<li>";
                        li += "<div class='team-name'>"+ team.displayName +"</div>";
                        li += "</li>";
                        semiFinals.append ( li );
                    } 
                });
            });
          


        };
        
        $("#sortable").disableSelection();



        var groupsArray;
        $.get ( "data/data.json", function ( data ) {
            groupsArray = data.Teams.slice ();
            populateParticle ( groupsArray );                
        });



        function populateParticle ( data ) {  
            var i = 1;
            $.each(data, function(index, team) {
                
                var groupParent = $('.league');  
                var li = "<li class='ui-state-default' id='"+team.teamid+"'><div class='drag-div'>";
                li += "<div class='team-img'><img src='"+imgBucket+""+team.displayName.toLowerCase()+".png' alt=''></div>";
                li += "<div class='team-name'>"+ team.fullName+"</div>";
                li += "</div></li>";
                groupParent.append ( li );
                i++;
            });
        }

    });
    </script>

</body>
</html>