<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>jQuery UI Sortable - Default functionality</title>
    <link rel="stylesheet" href="css/jquery-ui.min.css">
    <style>
    #sortable {
        list-style-type: none;
        margin: 0;
        padding: 0;
        width: 60%;
    }

    #sortable li {
        margin: 0 3px 3px 3px;
        padding: 0.4em;
        padding-left: 1.5em;
        font-size: 1.4em;
        height: 18px;
    }

    #sortable li span {
        position: absolute;
        margin-left: -1.3em;
    }
    </style>
</head>

<body>
    <ul id="sortable">
        <li class="ui-state-default" id='i1'><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 1</li>
        <li class="ui-state-default" id='i2'><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 2</li>
        <li class="ui-state-default" id='i3'><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 3</li>
        <li class="ui-state-default" id='i4'><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 4</li>
        <li class="ui-state-default" id='i5'><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 5</li>
        <li class="ui-state-default" id='i6'><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 6</li>
        <li class="ui-state-default" id='i7'><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 7</li>
        <li class="ui-state-default" id='i8'><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 8</li>
    </ul>
    <br>
    <button class="button">Get</button>


    <div class="swiper"></div>


    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script>
    $(function() {
        //  Team Sortable 
        $("#sortable").sortable({
            start: function(e, ui) {
                // creates a temporary attribute on the element with the old index
                $(this).attr('data-previndex', ui.item.index());
            },
            update: function(e, ui) {
                // gets the new and old index then removes the temporary attribute
                var newIndex = ui.item.index();
                var oldIndex = $(this).attr('data-previndex');
                var element_id = ui.item.attr('id');
                // alert('id of Item moved = ' + element_id + ' old position = ' + oldIndex + ' new position = ' + newIndex);
                $(this).removeAttr('data-previndex');
                $(this).attr('data-position', newIndex);
            }
        });
        
        $("#sortable").disableSelection();

        // Get Data
        $(".button").click(function(){
            var idsInOrder = $("#sortable").sortable("toArray");
            console.log(idsInOrder);
        });


        $.get ( "data/data-2018.json", function ( data ) {
            var groupsArray = data.Teams.slice ();
            populateParticle ( groupsArray );                
        });


        function chunks ( array, size ) {
            var results = [];
            var origArray = array.slice ();
            while ( origArray.length ) {
                results.push ( origArray.splice ( 0, size ) );
            }
            return results;
        }

        function populateParticle ( data ) {        


            var groups = data.length > 8 ? chunks ( data, 4 ) : data;
            var groupParent = $ ( '.swiper' );
            var i = 0, j = 0;
            console.log(groups);

            groups.forEach ( function ( group ) {
                var groupEl = $ ( '<ul data-index="' + i + '"></ul>' );
                var instructionsHtml = '<div class="instructions">' +
                        '<h3 class="group-title">Group</h3>' +
                    '</div>';
                groupEl.append ( instructionsHtml );
                groupParent.append ( groupEl );
                i++;

                group.forEach ( function ( team ) {
                    var teamdata = $.extend ( true, {}, team );
                    delete teamdata.cssClasses;
                    var li = $ ( "<li data-team='" + JSON.stringify ( teamdata ) + "'></li>" );
                    // li.append ( '<img src="' + imgBucket + team.qualifiedTeam.toLowerCase () + '.svg" />' );
                    li.append ( '<div class="team-name">' + team.displayName + '</div>' );
                    li.append ( '<div class="button ' + team.cssClasses + '" data-index="' + j + '"></div>' );
                    groupEl.append ( li );
                    j++;

                });

            } );

        }




    });
    </script>

</body>
</html>